# common

æµ‹è¯•å…¬å…±æ¨¡å—ï¼Œæä¾›æµ‹è¯•å·¥å…·å‡½æ•°å’ŒæœåŠ¡å™¨å¯åŠ¨é€»è¾‘ã€‚

## ğŸ§… ç¬¬ä¸€å±‚ï¼šåœ¨ Tests ä¸­çš„ä½ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          burncloud-tests                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                        æµ‹è¯•æ¨¡å—                                     â”‚    â”‚
â”‚   â”‚                                                                     â”‚    â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚   â”‚   â”‚â˜…common          â”‚  â”‚ api tests       â”‚  â”‚ ui tests        â”‚    â”‚    â”‚
â”‚   â”‚   â”‚                 â”‚  â”‚                 â”‚  â”‚                 â”‚    â”‚    â”‚
â”‚   â”‚   â”‚ æœåŠ¡å™¨å¯åŠ¨      â”‚  â”‚ API ç«¯ç‚¹æµ‹è¯•   â”‚  â”‚ UI æ¸²æŸ“æµ‹è¯•     â”‚    â”‚    â”‚
â”‚   â”‚   â”‚ æµ‹è¯•é…ç½®        â”‚  â”‚ é›†æˆæµ‹è¯•       â”‚  â”‚ ç»„ä»¶æµ‹è¯•        â”‚    â”‚    â”‚
â”‚   â”‚   â”‚ è¾…åŠ©å‡½æ•°        â”‚  â”‚                 â”‚  â”‚                 â”‚    â”‚    â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚   â”‚                                                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

common çš„èŒè´£:
â”œâ”€â”€ æµ‹è¯•æœåŠ¡å™¨å¯åŠ¨å’Œç®¡ç†
â”œâ”€â”€ æµ‹è¯•é…ç½®å’Œ Token
â”œâ”€â”€ ç«¯å£è‡ªåŠ¨å‘ç°
â””â”€â”€ æœåŠ¡å™¨å°±ç»ªç­‰å¾…
```

## ğŸ§… ç¬¬äºŒå±‚ï¼šæ–‡ä»¶ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       common æ–‡ä»¶ç»“æ„                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  crates/tests/tests/common/                                                  â”‚
â”‚  â”‚                                                                           â”‚
â”‚  â””â”€â”€ mod.rs              # å…¬å…±æµ‹è¯•å·¥å…·                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬ä¸‰å±‚ï¼šmod.rs è¯¦è§£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              mod.rs                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  æ¨¡å—èŒè´£: æä¾›æµ‹è¯•ç”¨çš„å…¬å…±å·¥å…·å‡½æ•°                                          â”‚
â”‚                                                                              â”‚
â”‚  å…¨å±€çŠ¶æ€:                                                                   â”‚
â”‚  static SERVER_HANDLE: OnceLock<ServerHandle>                                â”‚
â”‚                                                                              â”‚
â”‚  /// æœåŠ¡å™¨å¥æŸ„                                                              â”‚
â”‚  struct ServerHandle {                                                       â”‚
â”‚      pub base_url: String,        // æœåŠ¡å™¨åœ°å€                             â”‚
â”‚      pub process: Option<Child>,  // è¿›ç¨‹å¥æŸ„ (å¤ç”¨æ—¶ä¸º None)               â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬å››å±‚ï¼šæ ¸å¿ƒåŠŸèƒ½ - æœåŠ¡å™¨å¯åŠ¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æœåŠ¡å™¨å¯åŠ¨                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  /// å¯åŠ¨æµ‹è¯•åº”ç”¨æœåŠ¡å™¨                                                      â”‚
â”‚  pub async fn spawn_app() -> String                                          â”‚
â”‚  // è¿”å›: æœåŠ¡å™¨ base_url (å¦‚ "http://127.0.0.1:3000")                      â”‚
â”‚                                                                              â”‚
â”‚  æµç¨‹:                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  1. åŠ è½½ .env æ–‡ä»¶                                                   â”‚   â”‚
â”‚  â”‚     dotenv().ok()                                                   â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  2. æ£€æŸ¥ç«¯å£ 3000 æ˜¯å¦å·²å¼€æ”¾                                         â”‚   â”‚
â”‚  â”‚     â”œâ”€â”€ å¼€æ”¾ â†’ å¤ç”¨ç°æœ‰æœåŠ¡å™¨ (è¿”å› http://127.0.0.1:3000)           â”‚   â”‚
â”‚  â”‚     â””â”€â”€ æœªå¼€æ”¾ â†’ å¯åŠ¨æ–°æœåŠ¡å™¨                                        â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  3. å®šä½ burncloud äºŒè¿›åˆ¶æ–‡ä»¶                                        â”‚   â”‚
â”‚  â”‚     target/debug/burncloud (æˆ– .exe)                                â”‚   â”‚
â”‚  â”‚     ä¸å­˜åœ¨ â†’ panic!                                                  â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  4. è·å–ç©ºé—²ç«¯å£                                                     â”‚   â”‚
â”‚  â”‚     TcpListener::bind("127.0.0.1:0")                                â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  5. å¯åŠ¨æœåŠ¡å™¨è¿›ç¨‹                                                   â”‚   â”‚
â”‚  â”‚     burncloud server start                                          â”‚   â”‚
â”‚  â”‚     ç¯å¢ƒå˜é‡: PORT, RUST_LOG, NO_PROXY                              â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  6. ç­‰å¾…æœåŠ¡å™¨å°±ç»ª                                                   â”‚   â”‚
â”‚  â”‚     è½®è¯¢ GET /api/status ç›´åˆ°æˆåŠŸ                                   â”‚   â”‚
â”‚  â”‚     è¶…æ—¶: 5 ç§’ (50 æ¬¡ Ã— 100ms)                                      â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  7. è¿”å› base_url                                                    â”‚   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  å•ä¾‹æ¨¡å¼:                                                                   â”‚
â”‚  ä½¿ç”¨ OnceLock ç¡®ä¿æ•´ä¸ªæµ‹è¯•å¥—ä»¶åªå¯åŠ¨ä¸€æ¬¡æœåŠ¡å™¨                              â”‚
â”‚  å¹¶è¡Œæµ‹è¯•å…±äº«åŒä¸€ä¸ªæœåŠ¡å™¨å®ä¾‹                                                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬äº”å±‚ï¼šè¾…åŠ©å‡½æ•°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          è¾…åŠ©å‡½æ•°                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  /// æ£€æŸ¥ç«¯å£æ˜¯å¦å¼€æ”¾                                                        â”‚
â”‚  fn is_port_open(port: u16) -> bool                                          â”‚
â”‚  // å°è¯• TCP è¿æ¥ï¼ŒæˆåŠŸè¿”å› true                                            â”‚
â”‚                                                                              â”‚
â”‚  /// è·å–ç©ºé—²ç«¯å£                                                            â”‚
â”‚  fn get_free_port() -> u16                                                   â”‚
â”‚  // ç»‘å®š 127.0.0.1:0 è·å–ç³»ç»Ÿåˆ†é…çš„ç«¯å£                                     â”‚
â”‚                                                                              â”‚
â”‚  /// ç­‰å¾…æœåŠ¡å™¨å°±ç»ª                                                          â”‚
â”‚  async fn wait_for_server(url: &str)                                         â”‚
â”‚  // è½®è¯¢ GET {url}/api/status                                               â”‚
â”‚  // æœ€å¤š 50 æ¬¡ï¼Œæ¯æ¬¡é—´éš” 100ms                                              â”‚
â”‚  // è¶…æ—¶åˆ™ panic!                                                           â”‚
â”‚                                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                              â”‚
â”‚  /// è·å– root Token (æµ‹è¯•ç”¨)                                                â”‚
â”‚  pub fn get_root_token() -> String                                           â”‚
â”‚  // è¿”å›: "sk-root-token-123456"                                            â”‚
â”‚                                                                              â”‚
â”‚  /// è·å– demo Token (æµ‹è¯•ç”¨)                                                â”‚
â”‚  pub fn get_demo_token() -> String                                           â”‚
â”‚  // è¿”å›: "sk-burncloud-demo"                                               â”‚
â”‚                                                                              â”‚
â”‚  /// è·å– OpenAI æµ‹è¯•é…ç½®                                                    â”‚
â”‚  pub fn get_openai_config() -> Option<(String, String)>                      â”‚
â”‚  // è¿”å›: Some((api_key, base_url))                                         â”‚
â”‚  // ä»ç¯å¢ƒå˜é‡ TEST_OPENAI_KEY å’Œ TEST_OPENAI_BASE_URL è¯»å–                 â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬å…­å±‚ï¼šä½¿ç”¨ç¤ºä¾‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ä½¿ç”¨ç¤ºä¾‹                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  #[tokio::test]                                                              â”‚
â”‚  async fn test_some_api() {                                                  â”‚
â”‚      // 1. å¯åŠ¨æœåŠ¡å™¨ (æˆ–å¤ç”¨ç°æœ‰)                                          â”‚
â”‚      let base_url = spawn_app().await;                                       â”‚
â”‚                                                                              â”‚
â”‚      // 2. åˆ›å»º HTTP å®¢æˆ·ç«¯                                                 â”‚
â”‚      let client = reqwest::Client::new();                                    â”‚
â”‚                                                                              â”‚
â”‚      // 3. å‘é€è¯·æ±‚                                                         â”‚
â”‚      let response = client                                                   â”‚
â”‚          .get(&format!("{}/api/status", base_url))                           â”‚
â”‚          .send()                                                             â”‚
â”‚          .await                                                              â”‚
â”‚          .unwrap();                                                          â”‚
â”‚                                                                              â”‚
â”‚      // 4. éªŒè¯å“åº”                                                         â”‚
â”‚      assert!(response.status().is_success());                               â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                                                              â”‚
â”‚  #[tokio::test]                                                              â”‚
â”‚  async fn test_authenticated_api() {                                         â”‚
â”‚      let base_url = spawn_app().await;                                       â”‚
â”‚      let token = get_root_token();                                           â”‚
â”‚                                                                              â”‚
â”‚      let response = client                                                   â”‚
â”‚          .get(&format!("{}/api/users", base_url))                            â”‚
â”‚          .bearer_auth(&token)                                                â”‚
â”‚          .send()                                                             â”‚
â”‚          .await                                                              â”‚
â”‚          .unwrap();                                                          â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬ä¸ƒå±‚ï¼šæµ‹è¯•è®¾è®¡åŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          æµ‹è¯•è®¾è®¡åŸåˆ™                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  1. è‡ªå¯åŠ¨: æµ‹è¯•åº”èƒ½è‡ªåŠ¨å¯åŠ¨æ‰€éœ€çš„æœåŠ¡å™¨                                     â”‚
â”‚     â”œâ”€â”€ é¦–æ¬¡è¿è¡Œ: ç¼–è¯‘ + å¯åŠ¨æœåŠ¡å™¨                                         â”‚
â”‚     â””â”€â”€ åç»­è¿è¡Œ: å¤ç”¨å·²è¿è¡Œçš„æœåŠ¡å™¨ (èŠ‚çœæ—¶é—´)                              â”‚
â”‚                                                                              â”‚
â”‚  2. éš”ç¦»æ€§: æµ‹è¯•ä¹‹é—´ä¸åº”ç›¸äº’å¹²æ‰°                                             â”‚
â”‚     â”œâ”€â”€ ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®                                                  â”‚
â”‚     â””â”€â”€ é¿å…ä¾èµ–æ‰§è¡Œé¡ºåº                                                    â”‚
â”‚                                                                              â”‚
â”‚  3. æ— ç¡¬ç¼–ç : æ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’                                       â”‚
â”‚     â”œâ”€â”€ API Key: TEST_OPENAI_KEY                                            â”‚
â”‚     â””â”€â”€ Base URL: TEST_OPENAI_BASE_URL                                      â”‚
â”‚                                                                              â”‚
â”‚  4. å¿«é€Ÿå¤±è´¥: å¯åŠ¨å¤±è´¥åº”æœ‰æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯                                     â”‚
â”‚     â”œâ”€â”€ äºŒè¿›åˆ¶ä¸å­˜åœ¨ â†’ panic! æç¤ºç¼–è¯‘                                      â”‚
â”‚     â””â”€â”€ å¯åŠ¨è¶…æ—¶ â†’ panic! æç¤ºç«¯å£                                          â”‚
â”‚                                                                              â”‚
â”‚  5. CI å‹å¥½: é€‚åˆåœ¨ CI ç¯å¢ƒä¸­è¿è¡Œ                                            â”‚
â”‚     â”œâ”€â”€ è‡ªåŠ¨ç«¯å£åˆ†é…                                                        â”‚
â”‚     â””â”€â”€ æ— éœ€æ‰‹åŠ¨é…ç½®                                                        â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ä¾èµ–å…³ç³»

```
common
â””â”€â”€ external
    â”œâ”€â”€ tokio            # å¼‚æ­¥è¿è¡Œæ—¶
    â”œâ”€â”€ reqwest          # HTTP å®¢æˆ·ç«¯
    â””â”€â”€ dotenvy          # .env æ–‡ä»¶åŠ è½½
```
