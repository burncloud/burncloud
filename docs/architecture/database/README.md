# burncloud-database

æŒä¹…åŒ–å±‚ï¼ŒSQLx æ•°æ®åº“è®¿é—®ã€‚

## ğŸ§… ç¬¬ä¸€å±‚ï¼šç³»ç»Ÿä¸­çš„ä½ç½®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          BurnCloud å››å±‚æ¶æ„                                  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Layer 2: Control Plane (æ§åˆ¶å¹³é¢)                                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                     burncloud-server                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                     æä¾› REST API                                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚                                       â”‚
â”‚                                      â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Layer 1: Data Plane (æ•°æ®å¹³é¢)                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚                     burncloud-router                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                     å¤„ç† LLM è¯·æ±‚                                â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚                                       â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                    â”‚                 â”‚                 â”‚                    â”‚
â”‚                    â–¼                 â–¼                 â–¼                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Layer 3: Service   â”‚ â”‚  Layer 4: Data    â”‚ â”‚  Common               â”‚   â”‚
â”‚  â”‚                     â”‚ â”‚  â˜… å½“å‰          â”‚ â”‚                       â”‚   â”‚
â”‚  â”‚  service-*          â”‚ â”‚  database-*       â”‚ â”‚  å…±äº«ç±»å‹             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Database çš„èŒè´£:
â”œâ”€â”€ æ•°æ®åº“è¿æ¥æ± ç®¡ç†
â”œâ”€â”€ Schema è¿ç§»
â”œâ”€â”€ ç”¨æˆ·æ•°æ®å­˜å‚¨ (users, tokens, recharges)
â”œâ”€â”€ è·¯ç”±æ•°æ®å­˜å‚¨ (channels, abilities, router_logs)
â”œâ”€â”€ ä»·æ ¼æ•°æ®å­˜å‚¨ (prices, tiered_pricing, exchange_rates)
â””â”€â”€ é…ç½®æ•°æ®å­˜å‚¨ (protocol_configs, model_capabilities)
```

## ğŸ§… ç¬¬äºŒå±‚ï¼šDatabase æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          database æ•´ä½“æ¶æ„                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                          database.rs (æ ¸å¿ƒ)                            â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  pub struct Database {                                                 â”‚  â”‚
â”‚  â”‚      pub pool: SqlitePool,           // SQLite è¿æ¥æ±                   â”‚  â”‚
â”‚  â”‚  }                                                                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  create_default_database()                                       â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  1. ç¡®å®šæ•°æ®åº“ä½ç½® (é»˜è®¤: ~/.burncloud/burncloud.db)             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  2. åˆ›å»ºç›®å½•å’Œæ–‡ä»¶                                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  3. å»ºç«‹è¿æ¥æ±                                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  4. è¿è¡Œ Schema è¿ç§»                                             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  5. è¿”å› Database å®ä¾‹                                           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚                                       â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚            â”‚                         â”‚                         â”‚            â”‚
â”‚            â–¼                         â–¼                         â–¼            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚database-router   â”‚    â”‚ database-user    â”‚    â”‚ database-models      â”‚  â”‚
â”‚  â”‚                  â”‚    â”‚                  â”‚    â”‚                      â”‚  â”‚
â”‚  â”‚ RouterDatabase   â”‚    â”‚ UserDatabase     â”‚    â”‚ PriceModel           â”‚  â”‚
â”‚  â”‚ Token éªŒè¯       â”‚    â”‚ ç”¨æˆ· CRUD        â”‚    â”‚ TieredPriceModel     â”‚  â”‚
â”‚  â”‚ é…é¢ç®¡ç†         â”‚    â”‚ Token ç®¡ç†       â”‚    â”‚ ExchangeRateModel    â”‚  â”‚
â”‚  â”‚ æ—¥å¿—å­˜å‚¨         â”‚    â”‚ ä½™é¢æ“ä½œ         â”‚    â”‚ PriceV2Model         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚  â”‚database-setting  â”‚    â”‚database-download â”‚                              â”‚
â”‚  â”‚                  â”‚    â”‚                  â”‚                              â”‚
â”‚  â”‚ é”®å€¼å­˜å‚¨         â”‚    â”‚ ä¸‹è½½è¿½è¸ª         â”‚                              â”‚
â”‚  â”‚ ç³»ç»Ÿé…ç½®         â”‚    â”‚ æ–‡ä»¶ä¸‹è½½ç®¡ç†     â”‚                              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬ä¸‰å±‚ï¼šæºç ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            database/ ç»“æ„                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  crates/database/                                                            â”‚
â”‚  â”œâ”€â”€ src/                                                                    â”‚
â”‚  â”‚   â”œâ”€â”€ lib.rs              # æ¨¡å—å…¥å£                                     â”‚
â”‚  â”‚   â”œâ”€â”€ database.rs         # Database ç»“æ„å’Œè¿æ¥ç®¡ç†                      â”‚
â”‚  â”‚   â”œâ”€â”€ error.rs            # æ•°æ®åº“é”™è¯¯ç±»å‹                               â”‚
â”‚  â”‚   â””â”€â”€ schema.rs           # è¡¨ç»“æ„å®šä¹‰                                   â”‚
â”‚  â”‚                                                                          â”‚
â”‚  â””â”€â”€ crates/                                                                 â”‚
â”‚      â”œâ”€â”€ database-router/     # è·¯ç”±æ•°æ®æ“ä½œ                                â”‚
â”‚      â”‚   â””â”€â”€ src/lib.rs                                                      â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â”œâ”€â”€ database-user/       # ç”¨æˆ·æ•°æ®æ“ä½œ                                â”‚
â”‚      â”‚   â””â”€â”€ src/lib.rs                                                      â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â”œâ”€â”€ database-models/     # æ¨¡å‹/ä»·æ ¼æ•°æ®æ“ä½œ                           â”‚
â”‚      â”‚   â”œâ”€â”€ src/lib.rs                                                      â”‚
â”‚      â”‚   â””â”€â”€ src/main.rs      # CLI å·¥å…· (ä»·æ ¼ç®¡ç†)                         â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â”œâ”€â”€ database-setting/    # è®¾ç½®å­˜å‚¨                                    â”‚
â”‚      â”‚   â””â”€â”€ src/lib.rs                                                      â”‚
â”‚      â”‚                                                                       â”‚
â”‚      â””â”€â”€ database-download/   # ä¸‹è½½è¿½è¸ª                                    â”‚
â”‚          â””â”€â”€ src/lib.rs                                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬å››å±‚ï¼šæ•°æ®åº“è¡¨ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Schema                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        ç”¨æˆ·ç›¸å…³è¡¨                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  users                                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id TEXT PRIMARY KEY                                             â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ username TEXT UNIQUE                                             â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ password TEXT                    # bcrypt å“ˆå¸Œ                  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ role INTEGER                     # 1/10/100                     â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ balance_usd INTEGER              # çº³ç¾å…ƒ                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ balance_cny INTEGER              # çº³ç¾å…ƒç­‰å€¼                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ group TEXT                                                       â”‚    â”‚
â”‚  â”‚  â””â”€â”€ created_at TEXT                                                  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  tokens                                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id TEXT PRIMARY KEY                                              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ user_id TEXT â†’ users.id                                          â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ key TEXT UNIQUE                  # sk-xxxx                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ name TEXT                                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ status INTEGER                   # 1=æœ‰æ•ˆ, 0=ç¦ç”¨                â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ quota_limit INTEGER              # é…é¢é™åˆ¶                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ used_quota INTEGER               # å·²ä½¿ç”¨                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ expired_time TEXT                # è¿‡æœŸæ—¶é—´                       â”‚    â”‚
â”‚  â”‚  â””â”€â”€ accessed_time TEXT               # æœ€åè®¿é—®                      â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  recharges                                                            â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ user_id TEXT â†’ users.id                                          â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ amount INTEGER                   # å……å€¼é‡‘é¢                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ description TEXT                                                 â”‚    â”‚
â”‚  â”‚  â””â”€â”€ created_at TEXT                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        è·¯ç”±ç›¸å…³è¡¨                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  channels                                                             â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ type INTEGER                     # ChannelType æšä¸¾              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ key TEXT                         # API å¯†é’¥                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ base_url TEXT                                                     â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ models TEXT                      # é€—å·åˆ†éš”                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ group TEXT                                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ name TEXT                                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ priority INTEGER                                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ api_version TEXT                                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ param_override TEXT              # JSON                          â”‚    â”‚
â”‚  â”‚  â””â”€â”€ header_override TEXT             # JSON                          â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  abilities                                                            â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ group TEXT                       # ç”¨æˆ·ç»„                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ model TEXT                       # æ¨¡å‹å                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ channel_id INTEGER â†’ channels.id                                 â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ enabled INTEGER                  # 1/0                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ priority INTEGER                                                 â”‚    â”‚
â”‚  â”‚  â””â”€â”€ weight INTEGER                   # è´Ÿè½½å‡è¡¡æƒé‡                  â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  router_logs                                                          â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ request_id TEXT                                                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ user_id TEXT                                                      â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ path TEXT                                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ upstream_id TEXT                                                  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ status_code INTEGER                                              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ latency_ms INTEGER                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ prompt_tokens INTEGER                                            â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ completion_tokens INTEGER                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ cost REAL                        # ç¾å…ƒ                          â”‚    â”‚
â”‚  â”‚  â””â”€â”€ created_at TEXT                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        ä»·æ ¼ç›¸å…³è¡¨                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  prices                                                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ model TEXT                       # æ¨¡å‹å                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ currency TEXT                    # USD/CNY                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ input_price INTEGER              # çº³ç¾å…ƒ/ç™¾ä¸‡Token              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ output_price INTEGER                                              â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ cache_read_input_price INTEGER   # ç¼“å­˜è¯»å–ä»·æ ¼                  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ cache_creation_input_price INTEGER                               â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ batch_input_price INTEGER        # æ‰¹é‡ä»·æ ¼                      â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ batch_output_price INTEGER                                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ priority_input_price INTEGER     # ä¼˜å…ˆçº§ä»·æ ¼                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ priority_output_price INTEGER                                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ audio_input_price INTEGER        # éŸ³é¢‘ä»·æ ¼                      â”‚    â”‚
â”‚  â”‚  â””â”€â”€ region TEXT                      # cn/international/universal   â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  tiered_pricing                                                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ model TEXT                                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ region TEXT                      # cn/international             â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ tier_start INTEGER               # èµ·å§‹Tokenæ•°                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ tier_end INTEGER                 # ç»“æŸTokenæ•°                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ input_price INTEGER                                               â”‚    â”‚
â”‚  â”‚  â””â”€â”€ output_price INTEGER                                             â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  exchange_rates                                                       â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ from_currency TEXT               # USD                          â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ to_currency TEXT                 # CNY                          â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ rate INTEGER                     # ç¼©æ”¾åæ±‡ç‡ (Ã—10^9)           â”‚    â”‚
â”‚  â”‚  â””â”€â”€ updated_at TEXT                                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        é…ç½®ç›¸å…³è¡¨                                    â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  protocol_configs                                                     â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ channel_type INTEGER             # ChannelType                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ api_version TEXT                                                  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ chat_endpoint TEXT               # èŠå¤©ç«¯ç‚¹æ¨¡æ¿                  â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ request_mapping TEXT             # è¯·æ±‚æ˜ å°„ JSON                 â”‚    â”‚
â”‚  â”‚  â””â”€â”€ response_mapping TEXT            # å“åº”æ˜ å°„ JSON                 â”‚    â”‚
â”‚  â”‚                                                                      â”‚    â”‚
â”‚  â”‚  model_capabilities                                                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ id INTEGER PRIMARY KEY                                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ model TEXT                                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ context_window INTEGER           # ä¸Šä¸‹æ–‡çª—å£                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ max_output_tokens INTEGER                                         â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ supports_vision INTEGER          # 0/1                           â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ supports_function_calling INTEGER                                â”‚    â”‚
â”‚  â”‚  â””â”€â”€ ...                                                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬äº”å±‚ï¼šå­ Crate è¯¦è§£

### database-router - è·¯ç”±æ•°æ®æ“ä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          database-router                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DbRouterLog (æ—¥å¿—è®°å½•)                                                â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  pub struct DbRouterLog {                                              â”‚  â”‚
â”‚  â”‚      pub request_id: String,                                           â”‚  â”‚
â”‚  â”‚      pub user_id: Option<String>,                                      â”‚  â”‚
â”‚  â”‚      pub path: String,                                                 â”‚  â”‚
â”‚  â”‚      pub upstream_id: Option<String>,                                  â”‚  â”‚
â”‚  â”‚      pub status_code: i32,                                             â”‚  â”‚
â”‚  â”‚      pub latency_ms: i64,                                              â”‚  â”‚
â”‚  â”‚      pub prompt_tokens: i32,                                           â”‚  â”‚
â”‚  â”‚      pub completion_tokens: i32,                                       â”‚  â”‚
â”‚  â”‚      pub cost: f64,                                                    â”‚  â”‚
â”‚  â”‚  }                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  TokenValidationResult                                                 â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  pub enum TokenValidationResult {                                      â”‚  â”‚
â”‚  â”‚      Valid(TokenInfo),        // æœ‰æ•ˆ                                  â”‚  â”‚
â”‚  â”‚      Expired,                 // å·²è¿‡æœŸ                                â”‚  â”‚
â”‚  â”‚      Invalid,                 // æ— æ•ˆ                                  â”‚  â”‚
â”‚  â”‚  }                                                                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  pub struct TokenInfo {                                                â”‚  â”‚
â”‚  â”‚      pub user_id: String,                                              â”‚  â”‚
â”‚  â”‚      pub quota_limit: i64,                                             â”‚  â”‚
â”‚  â”‚      pub used_quota: i64,                                              â”‚  â”‚
â”‚  â”‚  }                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RouterDatabase                                                        â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  åˆå§‹åŒ–:                                                                â”‚  â”‚
â”‚  â”‚  pub async fn init(db: &Database) -> Result<()>                        â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  Token éªŒè¯:                                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ validate_token_and_get_info(db, token)                           â”‚  â”‚
â”‚  â”‚  â””â”€â”€ validate_token_detailed(db, token) â†’ TokenValidationResult       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  é…é¢æ“ä½œ:                                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ deduct_quota(db, user_id, token, amount) â†’ Result<()>            â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  é…ç½®åŠ è½½:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_all_upstreams(db) â†’ Result<Vec<DbUpstream>>                  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_all_groups(db) â†’ Result<Vec<DbGroup>>                        â”‚  â”‚
â”‚  â”‚  â””â”€â”€ get_group_members(db) â†’ Result<Vec<DbGroupMember>>               â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  æ—¥å¿—æ“ä½œ:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ insert_log(db, log) â†’ Result<()>                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€ query_logs(db, filters) â†’ Result<Vec<DbRouterLog>>               â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  Token ç»´æŠ¤:                                                            â”‚  â”‚
â”‚  â”‚  â””â”€â”€ update_token_accessed_time(db, token) â†’ Result<()>               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### database-user - ç”¨æˆ·æ•°æ®æ“ä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          database-user                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  UserDatabase                                                          â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  åˆå§‹åŒ–:                                                                â”‚  â”‚
â”‚  â”‚  pub async fn init(db: &Database) -> Result<()>                        â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  ç”¨æˆ· CRUD:                                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ create_user(db, input) â†’ Result<User>                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_user(db, id) â†’ Result<Option<User>>                          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_user_by_username(db, username) â†’ Result<Option<User>>        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ update_user(db, id, update) â†’ Result<User>                       â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ delete_user(db, id) â†’ Result<()>                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€ list_users(db, filter) â†’ Result<Vec<User>>                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  ä½™é¢æ“ä½œ (åŒå¸ç§):                                                     â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ update_balance(db, user_id, usd_delta, cny_delta) â†’ Result<()>   â”‚  â”‚
â”‚  â”‚  â””â”€â”€ get_balance(db, user_id) â†’ Result<(i64, i64)>                    â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  Token ç®¡ç†:                                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ create_token(db, input) â†’ Result<Token>                          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ list_tokens(db, user_id) â†’ Result<Vec<Token>>                    â”‚  â”‚
â”‚  â”‚  â””â”€â”€ delete_token(db, id) â†’ Result<()>                                â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  å……å€¼è®°å½•:                                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ add_recharge(db, user_id, amount, desc) â†’ Result<()>             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### database-models - æ¨¡å‹ä»·æ ¼æ“ä½œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         database-models                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PriceModel                                                            â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  ä»·æ ¼ CRUD:                                                             â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get(db, model, currency, region) â†’ Result<Option<Price>>         â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ set(db, input) â†’ Result<()>                                      â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ delete(db, model) â†’ Result<()>                                   â”‚  â”‚
â”‚  â”‚  â””â”€â”€ list_all(db) â†’ Result<Vec<Price>>                                â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  æˆæœ¬è®¡ç®—:                                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ calculate_cost(price, prompt, completion) â†’ i64                  â”‚  â”‚
â”‚  â”‚     // è¿”å›çº³ç¾å…ƒ                                                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  åŒºåŸŸå®šä»·:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_by_region(db, model, region) â†’ Result<Option<Price>>         â”‚  â”‚
â”‚  â”‚  â””â”€â”€ list_regions(db, model) â†’ Result<Vec<String>>                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  TieredPriceModel                                                      â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  åˆ†æ®µå®šä»·æ“ä½œ:                                                          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_tiers(db, model, region) â†’ Result<Vec<TieredPrice>>          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ add_tier(db, tier) â†’ Result<()>                                  â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ delete_tiers(db, model, region) â†’ Result<()>                     â”‚  â”‚
â”‚  â”‚  â””â”€â”€ has_tiered_pricing(db, model) â†’ Result<bool>                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  æ‰¹é‡å¯¼å…¥:                                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ import_from_json(db, json) â†’ Result<()>                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ExchangeRateModel                                                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  æ±‡ç‡æ“ä½œ:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_rate(db, from, to) â†’ Result<Option<i64>>                     â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ set_rate(db, from, to, rate) â†’ Result<()>                        â”‚  â”‚
â”‚  â”‚  â””â”€â”€ list_rates(db) â†’ Result<Vec<ExchangeRate>>                       â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  è´§å¸è½¬æ¢:                                                              â”‚  â”‚
â”‚  â”‚  â””â”€â”€ convert(db, amount, from, to) â†’ Result<i64>                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  PriceV2Model (æ–°ç‰ˆä»·æ ¼æ¨¡å‹)                                           â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  æ”¯æŒåŒå¸ç§å®šä»·:                                                        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_by_model_region(db, model, region) â†’ Result<Option<Price>>   â”‚  â”‚
â”‚  â”‚  â””â”€â”€ è‡ªåŠ¨æ±‡ç‡æ¢ç®—                                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### database-setting - è®¾ç½®å­˜å‚¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         database-setting                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SettingModel                                                          â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  é”®å€¼å­˜å‚¨:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get(db, key) â†’ Result<Option<String>>                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ set(db, key, value) â†’ Result<()>                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€ delete(db, key) â†’ Result<()>                                     â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  ç±»å‹åŒ–è¯»å–:                                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_int(db, key) â†’ Result<Option<i64>>                           â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get_bool(db, key) â†’ Result<Option<bool>>                         â”‚  â”‚
â”‚  â”‚  â””â”€â”€ get_json<T>(db, key) â†’ Result<Option<T>>                         â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  å¸¸ç”¨è®¾ç½®é”®:                                                            â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ system.locale           # è¯­è¨€è®¾ç½®                               â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ system.theme            # ä¸»é¢˜è®¾ç½®                               â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ billing.default_currency # é»˜è®¤è´§å¸                               â”‚  â”‚
â”‚  â”‚  â””â”€â”€ ...                                                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### database-download - ä¸‹è½½è¿½è¸ª

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         database-download                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  DownloadModel                                                         â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  ä¸‹è½½è®°å½•:                                                              â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ create(db, download) â†’ Result<Download>                          â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ get(db, id) â†’ Result<Option<Download>>                           â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ update_progress(db, id, progress) â†’ Result<()>                   â”‚  â”‚
â”‚  â”‚  â””â”€â”€ list_pending(db) â†’ Result<Vec<Download>>                         â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  Download ç»“æ„:                                                         â”‚  â”‚
â”‚  â”‚  {                                                                     â”‚  â”‚
â”‚  â”‚    id: i32,                                                            â”‚  â”‚
â”‚  â”‚    url: String,            // ä¸‹è½½ URL                                 â”‚  â”‚
â”‚  â”‚    target_path: String,    // ç›®æ ‡è·¯å¾„                                 â”‚  â”‚
â”‚  â”‚    status: String,         // pending/downloading/completed/failed    â”‚  â”‚
â”‚  â”‚    progress: i32,          // 0-100                                    â”‚  â”‚
â”‚  â”‚    total_bytes: i64,       // æ€»å¤§å°                                   â”‚  â”‚
â”‚  â”‚    downloaded_bytes: i64,  // å·²ä¸‹è½½                                   â”‚  â”‚
â”‚  â”‚    created_at: String,     // åˆ›å»ºæ—¶é—´                                 â”‚  â”‚
â”‚  â”‚  }                                                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬å…­å±‚ï¼šæ–‡ä»¶çº§è¯¦è§£

### lib.rs - æ¨¡å—å…¥å£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                               lib.rs                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  æ¨¡å—å£°æ˜:                                                                   â”‚
â”‚  pub mod database;                                                           â”‚
â”‚  pub mod error;                                                              â”‚
â”‚  pub mod schema;                                                             â”‚
â”‚                                                                              â”‚
â”‚  å…¬å¼€å¯¼å‡º:                                                                   â”‚
â”‚  pub use database::Database;                                                 â”‚
â”‚  pub use error::DatabaseError;                                               â”‚
â”‚  pub use schema::*;                                                          â”‚
â”‚                                                                              â”‚
â”‚  å­ crate å£°æ˜:                                                              â”‚
â”‚  pub use burncloud_database_router as router;                               â”‚
â”‚  pub use burncloud_database_user as user;                                   â”‚
â”‚  pub use burncloud_database_models as models;                               â”‚
â”‚  pub use burncloud_database_setting as setting;                             â”‚
â”‚  pub use burncloud_database_download as download;                           â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### database.rs - æ•°æ®åº“æ ¸å¿ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            database.rs                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  pub struct Database {                                                       â”‚
â”‚      pub pool: SqlitePool,              // SQLite è¿æ¥æ±                     â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  impl Database {                                                             â”‚
â”‚      pub async fn connect(url: &str) -> Result<Self>                         â”‚
â”‚      // è¿æ¥æ•°æ®åº“                                                          â”‚
â”‚                                                                              â”‚
â”‚      pub async fn create_default_database() -> Result<Self>                  â”‚
â”‚      // åˆ›å»ºé»˜è®¤æ•°æ®åº“ (å«è¿ç§»)                                             â”‚
â”‚      // 1. ç¡®å®šè·¯å¾„: ~/.burncloud/burncloud.db                              â”‚
â”‚      // 2. åˆ›å»ºç›®å½•å’Œæ–‡ä»¶                                                   â”‚
â”‚      // 3. å»ºç«‹è¿æ¥æ±                                                        â”‚
â”‚      // 4. è¿è¡Œè¿ç§»                                                         â”‚
â”‚                                                                              â”‚
â”‚      pub fn pool(&self) -> &SqlitePool                                       â”‚
â”‚      // è·å–è¿æ¥æ± å¼•ç”¨                                                      â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  è¿æ¥æ± é…ç½®:                                                                 â”‚
â”‚  â”œâ”€â”€ max_connections: 10                                                    â”‚
â”‚  â”œâ”€â”€ min_connections: 1                                                     â”‚
â”‚  â”œâ”€â”€ acquire_timeout: 30s                                                   â”‚
â”‚  â””â”€â”€ idle_timeout: 600s                                                     â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### error.rs - æ•°æ®åº“é”™è¯¯

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             error.rs                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  #[derive(Debug, thiserror::Error)]                                          â”‚
â”‚  pub enum DatabaseError {                                                    â”‚
â”‚      #[error("Connection failed: {0}")]                                      â”‚
â”‚      ConnectionError(String),                                                â”‚
â”‚                                                                              â”‚
â”‚      #[error("Query failed: {0}")]                                           â”‚
â”‚      QueryError(String),                                                     â”‚
â”‚                                                                              â”‚
â”‚      #[error("Migration failed: {0}")]                                       â”‚
â”‚      MigrationError(String),                                                 â”‚
â”‚                                                                              â”‚
â”‚      #[error("Record not found")]                                            â”‚
â”‚      NotFound,                                                               â”‚
â”‚                                                                              â”‚
â”‚      #[error("Duplicate record: {0}")]                                       â”‚
â”‚      DuplicateError(String),                                                 â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  impl From<sqlx::Error> for DatabaseError { ... }                            â”‚
â”‚  impl From<sqlx::migrate::MigrateError> for DatabaseError { ... }            â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### schema.rs - è¡¨ç»“æ„å®šä¹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             schema.rs                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  // ä½¿ç”¨ sqlx::query! å®è¿›è¡Œç¼–è¯‘æ—¶æ£€æŸ¥                                       â”‚
â”‚  // schema.rs å®šä¹‰ä¸æ•°æ®åº“è¡¨å¯¹åº”çš„ç»“æ„ä½“                                     â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbUser {                                                         â”‚
â”‚      pub id: String,                                                         â”‚
â”‚      pub username: String,                                                   â”‚
â”‚      pub password: String,                                                   â”‚
â”‚      pub role: i32,                                                          â”‚
â”‚      pub balance_usd: i64,                                                   â”‚
â”‚      pub balance_cny: i64,                                                   â”‚
â”‚      pub group_name: String,                                                 â”‚
â”‚      pub created_at: String,                                                 â”‚
â”‚  }                                                                           â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbToken { ... }                                                  â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbChannel { ... }                                                â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbAbility { ... }                                                â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbRouterLog { ... }                                              â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbPrice { ... }                                                  â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbTieredPrice { ... }                                            â”‚
â”‚                                                                              â”‚
â”‚  #[derive(Debug, Clone, FromRow)]                                            â”‚
â”‚  pub struct DbExchangeRate { ... }                                           â”‚
â”‚                                                                              â”‚
â”‚  // è½¬æ¢å®ç°                                                                 â”‚
â”‚  impl From<DbUser> for User { ... }                                          â”‚
â”‚  impl From<DbToken> for Token { ... }                                        â”‚
â”‚  // ...                                                                      â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§… ç¬¬ä¸ƒå±‚ï¼šæ•°æ®åº“è¿æ¥æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ•°æ®åº“è¿æ¥æµç¨‹                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    create_default_database()
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: ç¡®å®šæ•°æ®åº“ä½ç½®                                                      â”‚
â”‚                                                                              â”‚
â”‚  ä¼˜å…ˆçº§:                                                                     â”‚
â”‚  1. ç¯å¢ƒå˜é‡ DATABASE_URL                                                   â”‚
â”‚  2. é»˜è®¤è·¯å¾„: ~/.burncloud/burncloud.db                                     â”‚
â”‚                                                                              â”‚
â”‚  ç¤ºä¾‹:                                                                       â”‚
â”‚  sqlite:/path/to/burncloud.db   # ç»å¯¹è·¯å¾„                                  â”‚
â”‚  sqlite::memory:                # å†…å­˜æ•°æ®åº“ (æµ‹è¯•ç”¨)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: åˆ›å»ºç›®å½•å’Œæ–‡ä»¶                                                      â”‚
â”‚                                                                              â”‚
â”‚  åˆ›å»ºç›®å½•: ~/.burncloud/                                                     â”‚
â”‚  åˆ›å»ºæ–‡ä»¶: burncloud.db                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: å»ºç«‹è¿æ¥                                                           â”‚
â”‚                                                                              â”‚
â”‚  SqlitePool::connect(database_url)                                          â”‚
â”‚  é…ç½®:                                                                       â”‚
â”‚  â”œâ”€â”€ max_connections: 10                                                   â”‚
â”‚  â”œâ”€â”€ min_connections: 1                                                    â”‚
â”‚  â””â”€â”€ acquire_timeout: 30s                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 4: è¿è¡Œè¿ç§»                                                           â”‚
â”‚                                                                              â”‚
â”‚  sqlx::migrate!()                                                            â”‚
â”‚  â”œâ”€â”€ åˆ›å»ºæ‰€æœ‰è¡¨                                                             â”‚
â”‚  â”œâ”€â”€ åˆ›å»ºç´¢å¼•                                                               â”‚
â”‚  â””â”€â”€ åˆ›å»ºé»˜è®¤æ•°æ®                                                           â”‚
â”‚      â”œâ”€â”€ é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ· (root/root)                                         â”‚
â”‚      â””â”€â”€ é»˜è®¤æ±‡ç‡ (USD/CNY)                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
    è¿”å› Database å®ä¾‹
```

## ğŸ§… ä¾èµ–å…³ç³»

```
burncloud-database
â”œâ”€â”€ database (æ ¸å¿ƒ)
â”‚   â”œâ”€â”€ lib.rs
â”‚   â”œâ”€â”€ database.rs
â”‚   â”œâ”€â”€ error.rs
â”‚   â””â”€â”€ schema.rs
â”‚
â”œâ”€â”€ database-router
â”‚   â””â”€â”€ ä¾èµ–: burncloud-common
â”‚
â”œâ”€â”€ database-user
â”‚   â””â”€â”€ ä¾èµ–: burncloud-common
â”‚
â”œâ”€â”€ database-models
â”‚   â””â”€â”€ ä¾èµ–: burncloud-common
â”‚
â”œâ”€â”€ database-setting
â”‚   â””â”€â”€ ä¾èµ–: burncloud-common
â”‚
â””â”€â”€ database-download
    â””â”€â”€ ä¾èµ–: burncloud-common

å¤–éƒ¨ä¾èµ–:
â”œâ”€â”€ sqlx          # æ•°æ®åº“è®¿é—®
â”‚   â”œâ”€â”€ sqlite    # SQLite é©±åŠ¨
â”‚   â””â”€â”€ migrate   # è¿ç§»å·¥å…·
â””â”€â”€ serde_json    # JSON å¤„ç†
```
