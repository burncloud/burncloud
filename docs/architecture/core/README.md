# burncloud-core

核心工具和配置管理。

## 🧅 第一层：系统中的位置

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          BurnCloud 系统架构                                  │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │                        🛠️ 辅助工具层                                   │  │
│  │                                                                        │  │
│  │   CLI ─── Download ─── AutoUpdate ─── Code ─── ★ Core ─── Tests       │  │
│  │                                                              当前      │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘

Core 的职责:
├── 配置文件管理 (ConfigManager)
├── 模型生命周期管理 (ModelManager)
├── 本地模型下载和删除
└── 通用工具函数
```

## 🧅 第二层：Core 整体架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            burncloud-core                                    │
│                          (Core Utilities)                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌──────────────────────────────┐  ┌──────────────────────────────────────┐ │
│  │      config_manager.rs       │  │        model_manager.rs              │ │
│  │                              │  │                                      │ │
│  │  ┌────────────────────────┐  │  │  ┌────────────────────────────────┐  │ │
│  │  │    ConfigManager       │  │  │  │      ModelManager              │  │ │
│  │  │────────────────────────│  │  │  │────────────────────────────────│  │ │
│  │  │ load_config()          │  │  │  │ list_models()                  │  │ │
│  │  │ save_config()          │  │  │  │ get_model_info()               │  │ │
│  │  │ get/set fields         │  │  │  │ download_model()               │  │ │
│  │  └────────────────────────┘  │  │  │ delete_model()                 │  │ │
│  │                              │  │  │ check_model_status()           │  │ │
│  │  配置文件管理               │  │  └────────────────────────────────┘  │ │
│  │                              │  │                                      │ │
│  └──────────────────────────────┘  │  模型生命周期管理                   │ │
│                                    └──────────────────────────────────────┘ │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🧅 第三层：源码结构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                            core/ 结构                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  crates/core/                                                                │
│  └── src/                                                                    │
│      ├── lib.rs              # 入口                                         │
│      ├── config_manager.rs   # 配置文件管理                                 │
│      └── model_manager.rs    # 模型生命周期管理                             │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🧅 第四层：模块详解

### ConfigManager

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          ConfigManager                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  pub struct ConfigManager {                                                  │
│      // 配置管理器                                                           │
│  }                                                                           │
│                                                                              │
│  impl ConfigManager {                                                        │
│      pub fn load_config() -> Result<Config>;        # 加载配置              │
│      pub fn save_config(&self) -> Result<()>;       # 保存配置              │
│      pub fn get(&self, key: &str) -> Option<&str>;  # 获取字段              │
│      pub fn set(&mut self, key: &str, value: &str); # 设置字段              │
│  }                                                                           │
│                                                                              │
│  配置文件位置:                                                               │
│  • ~/.burncloud/config.json                                                  │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

### ModelManager

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          ModelManager                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  pub struct ModelManager {                                                   │
│      // 模型管理器                                                           │
│  }                                                                           │
│                                                                              │
│  impl ModelManager {                                                         │
│      pub fn list_models() -> Result<Vec<ModelInfo>>;    # 列出模型          │
│      pub fn get_model_info(&self, name: &str) -> Result<Option<ModelInfo>>; │
│      pub fn download_model(&self, name: &str) -> Result<()>; # 下载模型     │
│      pub fn delete_model(&self, name: &str) -> Result<()>;   # 删除模型     │
│      pub fn check_model_status(&self, name: &str) -> ModelStatus;           │
│  }                                                                           │
│                                                                              │
│  模型存储位置:                                                               │
│  • ~/.burncloud/models/                                                      │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 🧅 依赖关系

```
burncloud-core
├── burncloud-common        # 共享类型
└── external
    ├── serde               # 序列化
    └── tokio               # 异步运行时
```

## 🧅 使用场景

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              使用场景                                        │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  1. 本地模型管理                                                             │
│     • 列出已下载模型                                                        │
│     • 下载新模型                                                            │
│     • 删除旧模型                                                            │
│                                                                              │
│  2. 配置文件读写                                                             │
│     • 加载应用配置                                                          │
│     • 保存用户设置                                                          │
│     • 配置迁移                                                              │
│                                                                              │
│  3. 模型下载和删除                                                           │
│     • 从 HuggingFace 下载                                                   │
│     • 断点续传                                                              │
│     • 校验模型完整性                                                        │
│                                                                              │
└─────────────────────────────────────────────────────────────────────────────┘
```
